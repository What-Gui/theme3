<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="More obfuscation, exotic encryptions Fully homomorphic encryption is an extremely powerful notion, but it does not allow us to obtain fine control over the access to information. With the public key you can do all sorts of computation on the encrypted data, but you still do not learn it, while with the private key you learn everything. But in many situations we want fine grained access control: some people should get access to some of the information for some of the time. This makes the &ldquo;all or nothing&rdquo; nature of traditional encryptions problematic. While one could still implement such access control by interacting with the holder(s) of the secret key, this is not always possible.\n">
<title>Obfuscation II: applications</title>

<link rel='canonical' href='http://localhost:1313/p/obfuscation-ii-applications/'>

<link rel="stylesheet" href="/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css"><meta property='og:title' content="Obfuscation II: applications">
<meta property='og:description' content="More obfuscation, exotic encryptions Fully homomorphic encryption is an extremely powerful notion, but it does not allow us to obtain fine control over the access to information. With the public key you can do all sorts of computation on the encrypted data, but you still do not learn it, while with the private key you learn everything. But in many situations we want fine grained access control: some people should get access to some of the information for some of the time. This makes the &ldquo;all or nothing&rdquo; nature of traditional encryptions problematic. While one could still implement such access control by interacting with the holder(s) of the secret key, this is not always possible.\n">
<meta property='og:url' content='http://localhost:1313/p/obfuscation-ii-applications/'>
<meta property='og:site_name' content='Example Site'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' />
<meta name="twitter:title" content="Obfuscation II: applications">
<meta name="twitter:description" content="More obfuscation, exotic encryptions Fully homomorphic encryption is an extremely powerful notion, but it does not allow us to obtain fine control over the access to information. With the public key you can do all sorts of computation on the encrypted data, but you still do not learn it, while with the private key you learn everything. But in many situations we want fine grained access control: some people should get access to some of the information for some of the time. This makes the &ldquo;all or nothing&rdquo; nature of traditional encryptions problematic. While one could still implement such access control by interacting with the holder(s) of the secret key, this is not always possible.\n">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true}, 
                {left: "$", right: "$", display: false}  
            ]
        });
    });
</script>
<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu13739649187745961479.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Example Site</a></h1>
            <h2 class="site-description">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="http://localhost:1313/" selected>English</option>
                                
                                    <option value="http://localhost:1313/zh-cn/" >‰∏≠Êñá</option>
                                
                                    <option value="http://localhost:1313/ar/" >ÿπÿ±ÿ®Ÿä</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#slower-weaker-less-securer">Slower, weaker, less securer</a></li>
    <li><a href="#how-to-get-ibe-from-pairing-based-assumptions">How to get IBE from pairing based assumptions.</a></li>
    <li><a href="#beyond-pairing-based-cryptography">Beyond pairing based cryptography</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/obfuscation-ii-applications/">Obfuscation II: applications</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    12 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="more-obfuscation-exotic-encryptions">More obfuscation, exotic encryptions
</h1><p>Fully homomorphic encryption is an extremely powerful notion, but it does not allow us to obtain fine control over the access to information.
With the public key you can do all sorts of computation on the encrypted data, but you still do not learn it, while with the private key you learn everything.
But in many situations we want <em>fine grained access control</em>: some people should get access to some of the information for some of the time.
This makes the &ldquo;all or nothing&rdquo; nature of traditional encryptions problematic.
While one could still implement such access control by interacting with the holder(s) of the secret key, this is not always possible.</p>
<p>The most general notion of an encryption scheme allowing fine control is known as <em>functional encryption</em>, as was described in the previous lecture.
This can be viewed as an object dual to Fully Homomorphic Encryption, and incomparable to it.
For every function $f$, we can construct an <em>$f$-restricted decryption key</em>  $d_f$ that allows recovery of $f(m)$ from an encryption of $m$ but not anything else.</p>
<p>In this lecture we will focus on a weaker notion known as <em>identity based encryption (IBE)</em>.
Unlike the case of full fledged functional encryption, there are fairly efficient constructions known for IBE.</p>
<h2 id="slower-weaker-less-securer">Slower, weaker, less securer
</h2><p>In a sense, functional encryption or IBE is all about selective <em>leaking</em> of information.
That is, in some sense we want to modify an encryption scheme so that it actually is &ldquo;less secure&rdquo; in some very precise sense, so that it would be possible to learn something about the plaintext even without knowing the (full) decryption key.</p>
<p>There is actually a history of cryptographic technique meant to support such operations.
Perhaps the &ldquo;mother&rdquo; of all such &ldquo;quasi encryption&rdquo; schemes is the modular exponentiation operation $x \mapsto g^x$ for some discrete group $\mathbb{G}$.
The map $x \mapsto g^x$ is not exactly an encryption of $x$- for one thing, we don&rsquo;t know how to decrypt it.
Also, as a deterministic map, it cannot be semantically secure.
Nevertheless, if $x$ is random, or even high entropy, in groups such as cyclic subgroup of a multiplicative group modulo some prime, we don&rsquo;t know how to recover $x$ from $g^x$.
However, given $g^{x_1},\ldots,g^{x_k}$ and $a_1,\ldots,a_k$ we can find out if $\sum a_i x_i = 0$, and this can be quite useful in many applications.</p>
<p>More generally, even in the private key setting, people have studied encryption schemes such as</p>
<ul>
<li>
<p><strong>Deterministic encryption</strong> : an encryption scheme that maps $x$ to $E(x)$ in a deterministic way. This cannot be semantically secure in general but can be good enough if the message $x$ has high enough entropy or doesn&rsquo;t repeat and allows to check if two encryptions encrypt the same object. (We can also do this by publishing a hash of $x$ under some secret salt.)</p>
</li>
<li>
<p><strong>Order preserving encryption</strong>: is an encryption scheme mapping numbers in some range ${1,\ldots, N }$ to ciphertexts so that given $E(x)$ and $E(y)$ one can efficiently compare whether $x&lt;y$. This is quite problematic for security. For example, given $poly(t)$ random such encryptions you can more or less know where they lie in the interval up to $(1 \pm 1/t)$ multiplicative factor..</p>
</li>
<li>
<p><strong>Searchable encryption</strong>: is a generalization of deterministic encryption that allows some more sophisticated searchers (such as not only exact match).</p>
</li>
</ul>
<p>Some of these constructions can be quite efficient.
In particular the system <a class="link" href="https://css.csail.mit.edu/cryptdb/"  target="_blank" rel="noopener"
    >CryptDB</a> developed by Popa et al uses these kinds of encryptions to automatically turn a SQL database into one that works on encrypted data and still supports the required queries.
However, the issue of how dangerous the &ldquo;leakage&rdquo; can be is somewhat subtle. See this <a class="link" href="http://cryptoonline.com/wp-content/uploads/2013/03/edb.pdf"  target="_blank" rel="noopener"
    >paper</a> and <a class="link" href="https://outsourcedbits.org/2015/09/07/attacking-encrypted-database-systems/"  target="_blank" rel="noopener"
    >blog post</a> claiming weaknesses in practical use cases for CryptDB, as well as this <a class="link" href="https://css.csail.mit.edu/cryptdb/response.html"  target="_blank" rel="noopener"
    >response</a> by the CryptDB authors.</p>
<p>While the constructions of IBE and functional encryption often use maps such as $x \mapsto g^x$ as subroutines, they offer a stronger control over the leakage in the sense that, in the absence of publishing a (restricted) decryption key, we always get at least CPA security.</p>
<h2 id="how-to-get-ibe-from-pairing-based-assumptions">How to get IBE from pairing based assumptions.
</h2><p>The standard exponentiation mapping $x \mapsto g^x$ allows us to compute <em>linear functions in the exponent</em>.
That is, given any linear map $L$ of the form $L(x_1,\ldots,x_k) = \sum a_i x_i$, we can efficiently compute the map
$g^{x_1},\ldots, g^{x_k} \mapsto g^{L(x_1,\ldots,x_k)}$.
But can we do more?
In particular, can we compute <em>quadratic</em> functions?
This is an issue, as even computing the map $g^x,g^y \mapsto g^{xy}$ is exactly the Diffie Hellman problem that is considered hard in many of the groups we are interested in.</p>
<p><em>Pairing based cryptography</em> begins with the observation that in some elliptic curve groups we can use a map based on the so called Weil or Tate pairings.
The idea is that we have an efficiently computable isomorphism from a group $\mathbb{G}_1$ to a group $\mathbb{G}_2$ mapping $g$ to $\hat{g}$
such that we can efficiently map the elements $g^x$ and $g^y$ to the element $\varphi(g^x,g^y)=\hat{g}^{xy}$.
This in particular means that given $g^{x_1},\ldots,g^{x_k}$ we can compute $\hat{g}^{Q(x_1,\ldots,x_k)}$  for every quadratic $Q$.
Note that we cannot repeat this to compute, say, degree $4$ functions in the exponent,  since we don&rsquo;t know how to invert the map $\varphi$.</p>
<p>The <strong>Pairing Diffie Hellman Assumption</strong> is that we can find two such groups $\mathbb{G}_1,\mathbb{G}_2$ and generator $g$ for $\mathbb{G}$ such that there is no efficient algorithm $A$ that on input $g^a,g^b,g^c$ (for random $a,b,c \in {0,\ldots,|\mathbb{G}|-1}$) computes $\hat{g}^{abc}$.
That is, while we can compute a quadratic in the exponent, we can&rsquo;t compute a cubic.</p>
<p>We now show an IBE construction due to Boneh and Franklin<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> how we can obtain from the pairing diffie hellman assumption an identity based encryption:</p>
<ul>
<li>
<p><strong>Master key generation:</strong> We generate $\mathbb{G}_1,\mathbb{G}_2,g$ as above, choose $a$ at random in ${0,\ldots,|\mathbb{G}|-1}$. The master private key is $a$ and the master public key is $\mathbb{G}_1,\mathbb{G}_2,g,h=g^a$. We let $H:{0,1}^*\rightarrow\mathbb{G}_1$ and $H&rsquo;:\mathbb{G}_2\mapsto{0,1}^\ell$ be two hash functions modeled as random oracles.</p>
</li>
<li>
<p><strong>Key distribution:</strong>  Given an arbitrary string $id\in{0,1}^*$, we generate the decryption key corresponding to $id$, as $d_{id} = H(id)^a$.</p>
</li>
<li>
<p><strong>Encryption:</strong> To encrypt a message $m\in{0,1}^\ell$ given the public paramters and some id $id$, we choose $c\in {0,\ldots,|\mathbb{G}|-1}$, and output $g^c,H&rsquo;(id|\varphi(h,H(id))^c) \oplus m$</p>
</li>
<li>
<p><strong>Decryption:</strong> Given the secret key $d_{id}$ and a ciphertext $h&rsquo;,y$, we output $H&rsquo;(id|\varphi(d_{id},h&rsquo;))\oplus x$</p>
</li>
</ul>
<p><strong>Correctness:</strong> We claim that $D_{d_{id}}(E_{id}(m))=m$. Indeed, write $h_{id}=H(id)$ and let $b=\log_g h_{id}$. Then an encryption of $m$ has the form
$h&rsquo;=g^c, H&rsquo;(id|\varphi(g^a,h_{id})^c) \oplus m$, and so the second term is equal to $H&rsquo;(id|\hat{g}^{abc}) \oplus m$.
However, since $d_{id}= h_{id}^a = g^{ab}$, we get that $\varphi(h&rsquo;,d_{id})=\hat{g}^{abc}$ and hence decryption will recover the message. QED</p>
<p><strong>Security:</strong> To prove security we need to first present a <em>definition</em> of IBE security.
The definition allows the adversary to request keys corresponding to arbitrary identities, as long as it does not ask for keys corresponding to the target identity it wants to attack.
There are several variants, including CCA type of security definitions, but we stick to a simple one here:</p>
<p><strong>Definition:</strong> An IBE scheme is said to be CPA secure if every efficient adversary Eve wins the following game with probability at most $1/2+ negl(n)$:</p>
<ul>
<li>The keys are generated and Eve gets the master public key.</li>
<li>For $i=1,\ldots,T=poly(n)$, Eve chooses an identity $id_i \in {0,1}^*$ and gets the key $d_{id}$.</li>
<li>Eve chooses an identity $id^* \not\in {id_1,\ldots,id_T}$ and two messages $m_0,m_1$.</li>
<li>We choose $b\leftarrow_R{0,1}$ and Eve gets the encryption of $m_b$ with respect to the identity $id^*$.</li>
<li>Eve outputs $b&rsquo;$ and <em>wins</em> if $b&rsquo;=b$.</li>
</ul>
<p><strong>Theorem:</strong> If the pairing Diffie Hellman assumption holds and $H,H&rsquo;$ are random oracles, then the scheme above is CPA secure.</p>
<p><strong>Proof:</strong> Suppose for the sake of contradiction that there exists some time $T=poly(n)$ adversary $A$
that succeeds in the IBE-CPA with probability at least $1/2+\epsilon$ for some non-negligible $\epsilon$.
We assume without loss of generality that whenever $A$ makes a query to the key distribution function with id $id$ or a query to $H&rsquo;$ with prefix $id$, it had already previously made the query $id$ to $H$. ($A$ can be easily modified to have this behavior)</p>
<p>We will build an algorithm $B$ that on input $\mathbb{G}_1,\mathbb{G}_2,g,g^a,g^b,g^c$ will output $\hat{g}^{abc}$ with probability $poly(\epsilon,1/T)$.</p>
<p>The algorithm $B$ will guess $i_0, j_0 \leftarrow_R {1,\ldots, T}$ and simulate $A$ &ldquo;in its belly&rdquo; giving it the public key $g^a$, and act as follows:</p>
<ul>
<li>
<p>When $A$ makes a query to $H$ with $id$, then for all but the $i_0^{th}$ queries,  $B$ will chooose a random $b_{id} \in {0,\ldots, |\mathbb{G}|}$ (as usual we&rsquo;ll assume $|\mathbb{G}|$ is prime), choose $e_{id}=g^{b_{id}}$ and define $H(id)=e_{id}$.  Let $id_0$ be the $i_0^{th}$ query $A$ made to the oracle. We define $H(i_0)=g^b$ (where $g^b$ is the input to $B$- recall that $B$ does not know $b$.)</p>
</li>
<li>
<p>When $A$ makes a query to the key distribution oracle with $id$ then if $id\neq id_0$ then $B$ will then respond with $d_{id}=(g^a)^{b_{id}}$. If $id = id_0$ then $B$ aborts and fails.</p>
</li>
<li>
<p>When $A$ makes a query to the $H&rsquo;$ oracle with input $id&rsquo;|\hat{h}$ then for all but the $j_0^{th}$ query $B$ answers with a random string in ${0,1}^\ell$.  In the $j_0^{th}$ query, if $id&rsquo; \neq id_0$ then $B$ stops and fails. Otherwise, it outputs $\hat{h}$.</p>
</li>
<li>
<p>$B$ does stops the simulation and fails if we get to the challenge part.</p>
</li>
</ul>
<p>It might seem weird that we stop the simulation before we reach the challenge part, but the correctness of this reduction follows from the following claim:</p>
<p><strong>Claim:</strong> In the actual attack game, with probability at least $\epsilon/10$ $A$ will make the query $id_<em>| \hat{g}^{abc}$ to the $H&rsquo;$ oracle, where $H(id_</em>)=g^b$ and the public key is $g^a$.</p>
<p><strong>Proof:</strong> If $A$ does not make this query then the message in the challenge is XOR&rsquo;ed by a completely random string and $A$ cannot distinguish between $m_0$ and $m_1$ in this case with probability better than $1/2$. QED</p>
<p>Given this claim, to prove the theorem we just need to observe that, assuming it does not fail, $B$ provides answers to $A$ that are identically distributed to the answers $A$ receives in an actual execution of the CPA game, and hence with probability at least $\epsilon/(10T^2)$, $B$ will guess the query $i_0$ when $A$ queries $H(id_<em>)$ and set the answer to be $g^b$, and then guess the query $j_0$ when $A$ queries $id_</em>|\hat{g}^{abc}$ in which case $B$&rsquo;s output will be correct. QED</p>
<h2 id="beyond-pairing-based-cryptography">Beyond pairing based cryptography
</h2><p>Boneh and Silverberg asked the question of whether we could go beyond quadratic polynomials and get schemes that allow us to compute higher degree.
The idea is to get a <em>multilinear map</em> which would be a set of isomorphic groups $\mathbb{G}_1,\ldots,\mathbb{G}<em>d$ with generators $g_1,\ldots,g_d$ such that we can map $g_i^a$ and $g_j^b$ to $g</em>{i+j}^{ab}$.<br>
This way we would be able to compute any degree $d$ polynomial in the exponent given $g_1^{x_1},\ldots,g_1^{x_k}$.</p>
<p>We will now show how using such a multilinear map we can get a construction for a witness encryption scheme.
We will only show the construction, without talking about the security definition, the assumption, or security reductions.</p>
<p>Given some circuit $C:{0,1}^n\rightarrow{0,1}$ and some message $x$ we want to &ldquo;encrypt&rdquo; $x$ in a way that given $w$ such that $C(w)=1$ it would be possible to decrypt $x$, and otherwise it should be hard.
It should be noted that the encrypting party itself does not know any such $w$ and indeed (as in the case of the proof of Reimann hypothesis) might not even know if such a $w$ exists.
The idea is the following.
We use the fact that the <code>Exact Cover</code> problem is NP complete to map $C$ into collection of subsets $S_1,\ldots,S_{m}$ of the universe $U$ (where $m,|U|=poly(|C|,n)$)
such that there exists $w$ with $C(w)=1$ if and only if there exists $d$ sets $S_{i_1},\ldots,S_{i_d}$ that are a partition of $U$ (i.e., every element in $U$ is covered by exactly one of these sets), and moreover there is an efficient way to map $w$ to such a partition and vice versa.
Now, to encrypt the message $x$ we take a degree $d$ instance of multilinear maps $(\mathbb{G}<em>1,\ldots,\mathbb{G}</em>{d},g_1,\ldots,g_{d})$ (with all groups of size $p$) and choose random $a_1,\ldots,a_{|U|} \leftarrow_R {0,\ldots,p-1}$.
We then output the ciphertext $g_1^{\prod_{j\in S_1} a_j},\ldots,g_1^{\prod_{j\in S_m} a_j}, H(g_d^{\prod_{j\in U}^m a_j})\oplus x$.
Now, given a partition $S_{i_1},\ldots,S_{i_d}$ of the universe $d$, we can use the multilinear operations to compute $g_d^{\prod_{j\in U}a_j}$ and recover the message.
Intuitively, since the numbers are random, that would be the only way to come up with computing this value, but showing that requires formulating precise security definitions for both multilinear maps and witness encryption and of course a proof.</p>
<p>The first candidate construction for a multilinear map was given by <a class="link" href="https://eprint.iacr.org/2012/610"  target="_blank" rel="noopener"
    >Garg, Gentry and Halevi</a>.
It is based on computational questions on lattices and so (perhaps not surprisingly) it involves significant complications due to <em>noise</em>.
At a very high level, the idea is to use a fully homomorphic encryption scheme that can evaluate polynomials up to some degree $d$, but release a &ldquo;hobbled decryption key&rdquo; that contains just enough information to provide what&rsquo;s known as a <em>zero test</em>: check if an encryption is equal to zero.
Because of the homomorphic properties, that means that we can check given encryptions of $x_1,\ldots,x_n$ and some degree $d$ polynomial $P$, whether $P(x_1,\ldots,x_d)=0$.
Moreover, the notion of security this and similar construction satisfy is rather subtle and indeed not fully understood.
Constructions of indistinguishability obfuscators are built based on this idea, but are significantly more involved than the construction of a witness encryption.
One central tool they use is the observation that FHE reduces the task of obfuscation to essentially obfuscating a decryption circuit, which can often be rather shallow.
But beyond that there is significant work to be done to actually carry out the obfuscation.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>The construction we show was first published in the CRYPTO 2001 conference. The Weil and Tate pairings were used before for cryptographic attacks, but were used for a positive cryptographic result by Antoine Joux in his 2000 paper getting a three-party Diffie Hellman protocol and then Boneh and Franklin used this to obtain an identity based encryption scheme, answering an open question of Shamir. At approximately the same time as these papers, Sakai, Ohgishi and Kasahara presented a paper in the SCIS 2000 conference in Japan showing an identity-based key exchange protocol from pairing. Also <a class="link" href="https://en.wikipedia.org/wiki/Clifford_Cocks"  target="_blank" rel="noopener"
    >Clifford Cocks</a> (who as we mentioned above in the 1970&rsquo;s invented the RSA scheme at GCHQ before R,S, and A did), also came up in 2001 with a different identity-based encryption scheme using the quadratic residuosity assumption.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Example Person
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
